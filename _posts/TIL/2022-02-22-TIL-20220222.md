---
title: '2022-02-22 TIL(at work)'
categories:
- TIL
tag:
- [TIL]
last_modified_at: '2022-02-22 22:00:00 +0800'
---


## 업무 배경
### 이 업무가 할당된 이유
- 회사에서 맡고 있는 서비스 중, 회원이 구매를 신청하면 정부24에서 그 컨텐츠를 구매하여 제공을 하는 서비스가 있다. (참고로, 구매를 한다고 바로 완료되는게 아니라 구매 로직을 태운 후 실제로 컨텐츠를 가져오기까지 어느정도 시간이 소요된다.)
- 서비스 내에서 회원이 구매를 결정하여 정부24에서 그 컨텐츠를 구매하는 로직을 실행할 수 있는 곳은 서비스에서 총 4군데가 있는데, Header, Footer, 그리고 2개의 검색탭이다.
- 그런데 정부24에서 컨텐츠들을 구매할 때 너무 많은 양을 한 번에 구매하면, 다량의 신청건이 한꺼번에 신청 Queue에 몰리고, 또 입수 Queue에 몰리게 되므로, 과부하가 걸리곤 했다. 
- 회원은 유료 서비스를 이용하고 있지만 실제 컨텐츠를 제공받기까지 너무 시간이 오래 걸려서 직접 정부기관에서 구매를 하여 이중으로 컨텐츠 이용 금액을 사용하게 되거나, 사업실로 컴플레인을 거는 일이 많았다고 한다.
- 따라서 사업실에서는 많은 구매건이 진행중이거나 신규 신청건이 너무 많을 때 이에 대한 안내 팝업이 노출되도록 하여 어느정도 시간을 벌고, 또 이 팝업에서 다른 정부24 아이디를 입력하도록 하여 하나의 정부24 계정으로 감당 불가능한 양의 컨텐츠를 발급하는 것을 막고자 했다.

### 서비스 관련 배경 지식
- 이 서비스의 회원 구조는 본사 - 지점 - 내부 사용자의 3 depth로 되어있다.
- 회원이 로그인을 하고 나면, 정부24에서 발급하는 몇가지 서류를 발급할 때 이 회원의 정부24 아이디로 로그인을 하게 되어 있다.

## 개발 요건 파악
### 요청사항 파악
- 세션의 정부24 아이디로 발급 진행중인 컨텐츠의 수와 새로 신청하는 정부24 컨텐츠의 수를 합쳐 50건이 넘으면 팝업이 뜬다.(참고로, 실제로는 50건이 아니다. 업무 내용을 모두 솔직히 블로그에는 적을 수 없어서 약간 각색했다.)
- 이 팝업에서는 하나의 정부24 계정으로 신청하려는 or 진행중인 컨텐츠의 건수가 50건이 넘으니 시간이 오래 소요된다는 점을 안내하고, 다른 정부24 계정을 사용하도록 유도한다.
- '계정 변경' 버튼과 '취소' 버튼이 존재한다.
  - '계정 변경'을 누르면 새로운 계정을 사용하는 것이다. (로그인 로직이 실행되도록 해야한다.)
  - '취소' 버튼을 클릭하면 이 팝업을 닫는다.

### 업무 수행 계획
- 구매 버튼을 누를 때, 세션에 있는 정부24 아이디로 발급중인 컨텐츠의 건수를 세는 API를 개발한다. 혹은 기존 API를 사용할 수 있는지 찾아본다.
- '계정 변경'을 눌렀을 때, 새로운 계정으로 로그인 되고, 그 이후에 구매 버튼을 클릭하게 하면 다시 50건 락 팝업을 띄울지 말지 (건수 카운팅) 로직을 실행해야 하므로, 어디서 이 로직을 타게할 것인지 결정해야 한다.
- 새로운 계정으로 변경했을 때, 구매가 가능한 경우 구매 데이터를 적재하는 테이블에, 변경된 계정 정보가 잘 들어갔는지 확인해야 한다.
- 회원이 구매하는 컨텐츠에서 정부24에서 구매하는 컨텐츠와 그렇지 않은 컨텐츠가 섞여있는 경우 이를 어떻게 처리할지 결정한다.
- 회원이 체크리스트에서 체크한 건수를 카운트하고, 진행중인 건수를 더하여 50건이 넘는지 확인하는 로직을 프론트(JavaScript)에서 처리할지, 백(Java)에서 처리할지 생각해본다.

